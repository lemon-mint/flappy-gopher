
<!DOCTYPE html>
<html>
<head>
  <title>플러피 고퍼</title>
  <style>
    body {
      background-color: #70c5ce;
      overflow: hidden;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      touch-action: manipulation; 
    }
    canvas {
      background-color: #70c5ce;
      max-width: 100%;
      max-height: 100%;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const gopher = new Image();
    gopher.src = '/gopher.png'; 

    let canvasWidth = canvas.width = window.innerWidth;
    let canvasHeight = canvas.height = window.innerHeight;
    
    let gopherX = canvasWidth * 0.2; // 왼쪽에서 약간 벗어남
    let gopherY = canvasHeight / 2 - 25;
    const gopherWidth = 50; 
    const gopherHeight = 50;
    let gopherVelocity = 0;
    const gopherGravity = 0.1; 
    const terminalVelocity = 5; 
    const jumpPower = -5;

    const pipeGap = 200;
    const pipeWidth = 50;
    let pipeX = canvasWidth;
    let pipeY = Math.random() * (canvasHeight - pipeGap - 200) + 100;
    const pipeSpeed = 2;

    let score = 0;
    let gameStatus = 'running'; 

    window.addEventListener('resize', () => {
      canvasWidth = canvas.width = window.innerWidth;
      canvasHeight = canvas.height = window.innerHeight;
    });

    const handleJump = () => {
      if (gameStatus === 'running') {
        gopherVelocity = jumpPower;
      } else if (gameStatus === 'gameover') {
        resetGame();
      }
    }

    canvas.addEventListener('click', handleJump);
    canvas.addEventListener('touchstart', handleJump);
    document.addEventListener('keydown', (event) => {
      if (event.code === 'Space') {
        event.preventDefault(); 
        handleJump(); 
      }
    });

    function drawGopher() {
      ctx.drawImage(gopher, gopherX, gopherY, gopherWidth, gopherHeight);
    }

    function drawPipes() {
      ctx.fillStyle = 'green';
      ctx.fillRect(pipeX, 0, pipeWidth, pipeY);
      ctx.fillRect(pipeX, pipeY + pipeGap, pipeWidth, canvasHeight - pipeY - pipeGap);
    }

    function drawScore() {
      ctx.font = '20px Arial';
      ctx.fillStyle = '#000';
      ctx.fillText('점수: ' + score, 10, 30);
    }

    function drawGameOver() {
      ctx.font = '30px Arial';
      ctx.fillStyle = 'red';
      ctx.fillText('게임 오버!', canvasWidth / 2 - 100, canvasHeight / 2); 
      ctx.font = '20px Arial';
      ctx.fillText('스페이스바, 클릭 또는 터치하여 재시작', canvasWidth / 2 - 180, canvasHeight / 2 + 50);
    }

    function resetGame() {
      gameStatus = 'running';
      score = 0;
      gopherX = canvasWidth * 0.2; // 왼쪽에서 약간 벗어남
      gopherY = canvasHeight / 2 - 25;
      pipeX = canvasWidth;
      pipeY = Math.random() * (canvasHeight - pipeGap - 200) + 100;
    }

    function update() {
      if (gameStatus === 'running') {
        gopherVelocity += gopherGravity;
        if (gopherVelocity > terminalVelocity) {
          gopherVelocity = terminalVelocity;
        }
        gopherY += gopherVelocity;

        pipeX -= pipeSpeed;
        if (pipeX + pipeWidth < 0) {
          pipeX = canvasWidth;
          pipeY = Math.random() * (canvasHeight - pipeGap - 200) + 100;
          score++;
        }

        if (
          gopherY + gopherHeight > canvasHeight ||
          gopherY < 0 ||
          (gopherX + gopherWidth > pipeX &&
            gopherX < pipeX + pipeWidth &&
            (gopherY < pipeY || gopherY + gopherHeight > pipeY + pipeGap))
        ) {
          gameStatus = 'gameover';
        }

        ctx.clearRect(0, 0, canvasWidth, canvasHeight);
        drawGopher();
        drawPipes();
        drawScore();
      } else if (gameStatus === 'gameover') {
        drawGameOver();
      }

      requestAnimationFrame(update); 
    }

    update(); 
  </script>
</body>
</html>
